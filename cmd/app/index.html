<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–ö–∞—Ç–∞–ª–æ–≥ —Ñ–∏–ª—å–º–æ–≤</title>
  <style>
    :root {
      --primary: #4361ee;
      --secondary: #3f37c9;
      --accent: #4895ef;
      --light: #f8f9fa;
      --dark: #212529;
      --success: #4cc9f0;
      --danger: #f72585;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s ease;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
      padding: 40px 20px;
      color: var(--dark);
      line-height: 1.6;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
      background-color: white;
      border-radius: 15px;
      box-shadow: var(--shadow);
      overflow: hidden;
      animation: fadeIn 0.5s ease-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    header {
      background: linear-gradient(to right, var(--primary), var(--secondary));
      color: white;
      padding: 25px 20px;
      text-align: center;
    }
    
    h1 {
      font-size: 2.2rem;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
    }
    
    .content {
      padding: 30px;
    }
    
    .form-container {
      background: white;
      border-radius: 10px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(0, 0, 0, 0.1);
    }
    
    .form-title {
      font-size: 1.5rem;
      margin-bottom: 20px;
      color: var(--primary);
      display: flex;
      align-items: center;
    }
    
    .form-title::before {
      content: "üé¨";
      margin-right: 10px;
    }
    
    form {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-group.full-width {
      grid-column: span 2;
    }
    
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--dark);
    }
    
    input, textarea, select {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      font-size: 1rem;
      transition: var(--transition);
    }
    
    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
    }
    
    textarea {
      min-height: 100px;
      resize: vertical;
    }
    
    .button-group {
      grid-column: span 2;
      display: flex;
      gap: 15px;
      margin-top: 10px;
    }
    
    button {
      padding: 12px 25px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    button.primary {
      background: linear-gradient(to right, var(--primary), var(--accent));
      color: white;
    }
    
    button.secondary {
      background: white;
      color: var(--primary);
      border: 2px solid var(--primary);
    }
    
    button.danger {
      background: linear-gradient(to right, var(--danger), #ff7096);
      color: white;
    }
    
    button i {
      margin-right: 8px;
    }
    
    .movies-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
    }
    
    .movie-card {
      background: white;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: var(--shadow);
      transition: var(--transition);
      border: 1px solid rgba(0, 0, 0, 0.1);
    }
    
    .movie-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }
    
    .movie-header {
      background: linear-gradient(to right, var(--primary), var(--secondary));
      color: white;
      padding: 15px;
    }
    
    .movie-header h3 {
      margin: 0;
      font-size: 1.2rem;
    }
    
    .movie-body {
      padding: 15px;
    }
    
    .movie-meta {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      font-size: 0.9rem;
    }
    
    .movie-genre {
      background: var(--accent);
      color: white;
      padding: 3px 10px;
      border-radius: 20px;
      font-size: 0.8rem;
      display: inline-block;
    }
    
    .movie-description {
      margin: 15px 0;
      color: #555;
      font-size: 0.95rem;
    }
    
    .movie-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
    
    .movie-actions button {
      padding: 8px 15px;
      font-size: 0.9rem;
      flex: 1;
    }
    
    .empty-state {
      grid-column: span 2;
      text-align: center;
      padding: 40px;
      color: #666;
    }
    
    .empty-state i {
      font-size: 3rem;
      margin-bottom: 20px;
      color: #ccc;
    }
    
    .hidden {
      display: none !important;
    }
    
    @media (max-width: 768px) {
      form {
        grid-template-columns: 1fr;
      }
      
      .form-group.full-width, .button-group {
        grid-column: span 1;
      }
      
      .movies-container {
        grid-template-columns: 1fr;
      }
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
  <div class="container">
    <header>
      <h1><i class="fas fa-film"></i> –ö–∞—Ç–∞–ª–æ–≥ —Ñ–∏–ª—å–º–æ–≤</h1>
    </header>
    
    <div class="content">
      <div class="form-container">
        <h2 class="form-title">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ñ–∏–ª—å–º</h2>
        <form id="movieForm">
          <input type="hidden" id="movieId" />
          <div class="form-group">
            <label for="title"><i class="fas fa-heading"></i> –ù–∞–∑–≤–∞–Ω–∏–µ</label>
            <input type="text" id="title" required placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞" />
          </div>
          <div class="form-group">
            <label for="genre"><i class="fas fa-tags"></i> –ñ–∞–Ω—Ä</label>
            <input type="text" id="genre" placeholder="–£–∫–∞–∂–∏—Ç–µ –∂–∞–Ω—Ä" />
          </div>
          <div class="form-group">
            <label for="year"><i class="fas fa-calendar-alt"></i> –ì–æ–¥ –≤—ã–ø—É—Å–∫–∞</label>
            <input type="number" id="year" placeholder="–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞" min="1900" max="2100" />
          </div>
          <div class="form-group full-width">
            <label for="description"><i class="fas fa-align-left"></i> –û–ø–∏—Å–∞–Ω–∏–µ</label>
            <textarea id="description" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞"></textarea>
          </div>
          <div class="button-group">
            <button type="submit" class="primary">
              <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∏–ª—å–º
            </button>
            <button type="button" id="cancelEdit" class="secondary hidden">
              <i class="fas fa-times"></i> –û—Ç–º–µ–Ω–∞
            </button>
          </div>
        </form>
      </div>
      
      <div id="moviesList" class="movies-container">
        <!-- –§–∏–ª—å–º—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
      </div>
    </div>
  </div>

  <script>
    const apiUrl = 'http://localhost:8080/movies'; // –ø–æ–º–µ–Ω—è–π –Ω–∞ —Å–≤–æ–π –±—ç–∫–µ–Ω–¥

    const movieForm = document.getElementById('movieForm');
    const movieIdInput = document.getElementById('movieId');
    const titleInput = document.getElementById('title');
    const genreInput = document.getElementById('genre');
    const yearInput = document.getElementById('year');
    const descriptionInput = document.getElementById('description');
    const cancelEditBtn = document.getElementById('cancelEdit');
    const moviesList = document.getElementById('moviesList');

    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Ñ–∏–ª—å–º–æ–≤
    async function loadMovies() {
      try {
        const res = await fetch(apiUrl);
        const movies = await res.json();
        
        moviesList.innerHTML = '';
        
        if (movies.length === 0) {
          moviesList.innerHTML = `
            <div class="empty-state">
              <i class="fas fa-film fa-3x"></i>
              <h3>–§–∏–ª—å–º–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h3>
              <p>–î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π —Ñ–∏–ª—å–º —Å –ø–æ–º–æ—â—å—é —Ñ–æ—Ä–º—ã –≤—ã—à–µ</p>
            </div>
          `;
          return;
        }
        
        movies.forEach(movie => {
          const movieCard = document.createElement('div');
          movieCard.className = 'movie-card';
          movieCard.innerHTML = `
            <div class="movie-header">
              <h3>${movie.title}</h3>
            </div>
            <div class="movie-body">
              <div class="movie-meta">
                <span><i class="fas fa-calendar-alt"></i> ${movie.year || '–ù–µ —É–∫–∞–∑–∞–Ω'}</span>
                ${movie.genre ? `<span class="movie-genre"><i class="fas fa-tag"></i> ${movie.genre}</span>` : ''}
              </div>
              ${movie.description ? `<p class="movie-description">${movie.description}</p>` : ''}
              <div class="movie-actions">
                <button onclick="editMovie(${movie.id})" class="primary">
                  <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                </button>
                <button onclick="deleteMovie(${movie.id})" class="danger">
                  <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
                </button>
              </div>
            </div>
          `;
          moviesList.appendChild(movieCard);
        });
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∏–ª—å–º–æ–≤:', error);
        moviesList.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-exclamation-triangle fa-3x"></i>
            <h3>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h3>
            <p>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∏–ª—å–º–æ–≤</p>
          </div>
        `;
      }
    }

    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å–º–∞
    movieForm.addEventListener('submit', async (e) => {
      e.preventDefault();

      try {
        const movieData = {
          title: titleInput.value,
          genre: genreInput.value,
          year: yearInput.value ? Number(yearInput.value) : null,
          description: descriptionInput.value
        };

        const id = movieIdInput.value;
        let method = 'POST';
        let url = apiUrl;

        if (id) {
          method = 'PUT';
          url += `/${id}`;
        }

        const res = await fetch(url, {
          method,
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(movieData)
        });

        if (res.ok) {
          resetForm();
          loadMovies();
        } else {
          throw new Error('–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
        }
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ–∏–ª—å–º–∞:', error);
        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ–∏–ª—å–º–∞');
      }
    });

    // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞ - –∑–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É
    window.editMovie = async (id) => {
      try {
        const res = await fetch(`${apiUrl}/${id}`);
        if (!res.ok) {
          throw new Error('–§–∏–ª—å–º –Ω–µ –Ω–∞–π–¥–µ–Ω');
        }
        
        const movie = await res.json();
        movieIdInput.value = movie.id;
        titleInput.value = movie.title;
        genreInput.value = movie.genre || '';
        yearInput.value = movie.year || '';
        descriptionInput.value = movie.description || '';
        cancelEditBtn.classList.remove('hidden');
        
        // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Ñ–æ—Ä–º–µ
        document.querySelector('.form-title').scrollIntoView({
          behavior: 'smooth'
        });
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ñ–æ—Ä–º—ã
        document.querySelector('.form-title').innerHTML = `
          <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞
        `;
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ñ–∏–ª—å–º–∞:', error);
        alert('–§–∏–ª—å–º –Ω–µ –Ω–∞–π–¥–µ–Ω');
      }
    };

    cancelEditBtn.addEventListener('click', () => {
      resetForm();
    });

    // –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∏–ª—å–º–∞
    window.deleteMovie = async (id) => {
      if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ñ–∏–ª—å–º?')) return;
      
      try {
        const res = await fetch(`${apiUrl}/${id}`, { method: 'DELETE' });
        if (res.ok) {
          loadMovies();
        } else {
          throw new Error('–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
        }
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ñ–∏–ª—å–º–∞:', error);
        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ñ–∏–ª—å–º–∞');
      }
    };

    function resetForm() {
      movieIdInput.value = '';
      movieForm.reset();
      cancelEditBtn.classList.add('hidden');
      document.querySelector('.form-title').innerHTML = `
        <i class="fas fa-plus-circle"></i> –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ñ–∏–ª—å–º
      `;
    }

    // –ù–∞—á–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
    loadMovies();
  </script>
</body>
</html>